let cardData = {
	curse_bridge_troll: {
		type: 'curse',
		title: 'Проклятье Мостового Тролля',
		description: 'Твой следующий вопрос нужно задать из-под моста.',
		bylaws:
			'"Мост" — это любое возвышенное сооружение, служащее путём, дорогой или железной дорогой, предназначенное для пересечения пешеходами, машинами или другими транспортными средствами. Все искатели должны иметь какую-то часть тела под частью моста, когда задаётся следующий вопрос. Если на карте игры нет мостов, это проклятье нужно убрать из колоды.',
		file: 'curse_bridge_troll',
	},
	curse_cairn: {
		type: 'curse',
		title: 'Проклятье Каменщика',
		description:
			'Я сложил ___ камней друг на друга, и это простояло 5 секунд. Теперь тебе нужно сложить столько же камней и удержать их 5 секунд, прежде чем задать новый вопрос. Камни должны быть найдены в природе, а после постройки их нужно разложить.',
		bylaws: `Ты не можешь начать выполнять стоимость применения этого проклятья, если иначе не можешь сыграть проклятье; как только стоимость выполнена, проклятье должно быть применено немедленно. "Найденные в природе" в данном контексте не обязательно означает найденные в природной зоне или не тронутые человеком; это просто значит, что ты должен найти камни сам и не можешь их купить.`,
		file: 'curse_cairn',
	},
	curse_distant_cuisine: {
		type: 'curse',
		title: 'Проклятье Далёкой Кухни',
		description:
			'Я нашёл ресторан, где подают еду из ___. Тебе нужно посетить ресторан с кухней страны, которая находится на равном или большем расстоянии, прежде чем задать новый вопрос.',
		bylaws: `Рестораны, используемые для этого проклятья, должны явно указывать одну страну или регион внутри страны в своём названии или других публичных материалах, таких как меню. Если ресторан ассоциируется с несколькими странами или регионом больше одной страны (например, "азиатский ресторан"), он не подходит для этого проклятья. Расстояние от данной страны измеряется от твоего точного местоположения до ближайшей точки этой страны.`,
		file: 'curse_distant_cuisine',
	},
	curse_drained_brain: {
		type: 'curse',
		title: 'Проклятье Истощённого Мозга',
		description:
			'На всё моё время игры ты не можешь задавать эти вопросы: ___, ___, и ___.',
		bylaws: `Это проклятье можно использовать (и оплатить его стоимость) в интервале времени между вопросом и ответом, позволяя игроку сбросить руку перед получением награды за данный вопрос. Однако ты не можешь запретить вопрос, который только что был задан, даже если ещё не ответил на него. Вопросы, удалённые из игры с помощью этого проклятья, нельзя задавать, даже за повышенную стоимость.`,
		file: 'curse_drained_brain',
	},
	curse_egg_partner: {
		type: 'curse',
		title: 'Проклятье Антикастрата',
		description:
			'Тебе нужно достать яйцо, прежде чем задать новый вопрос. Это яйцо теперь официальный член команды. Если яйцо треснет до конца моего раунда, я получаю бонус: (S 30) (M 45) (L 60) минут.',
		bylaws: `Яйцо может быть от любого животного, но должно быть настоящим (шоколадное или пластиковое яйцо, например, не считается). Любая видимая трещина, даже маленькая, считается гибелью яйца. Если ты не хочешь покупать предметы во время игры или возражаешь против этого проклятья по этическим причинам, его нужно убрать из колоды. Для любого другого проклятья, требующего действия от всех искателей, яйцо считается искателем. Например, использование Проклятья Лимонного Филактерия после этого проклятья потребует прикрепить лимон к яйцу.`,
		file: 'curse_egg_partner',
	},
	curse_endless_tumble: {
		type: 'curse',
		title: 'Проклятье Бесконечного Падения',
		description: `Тебе нужно бросить кубик не менее чем на 30 метров и иметь выпавшее 5 или 6, прежде чем задать новый вопрос. Кубик должен прокатиться всю дистанцию самостоятельно, используя только импульс от броска и гравитацию. Если ты случайно попадёшь кубиком в кого-то, я получаю бонус: (S 10) (M 20) (L 30) минут.`,
		bylaws: `30 метров измеряются параллельно земле. Кубик можно, и, вероятно, стоит бросать на наклонной поверхности. Если кубик потерян или не лёг ровно на одну грань, он не считается. Любые бонусы, полученные спрятавшимся, должны быть выданы немедленно.`,
		file: 'curse_endless_tumble',
	},
	curse_gamblers_feet: {
		type: 'curse',
		title: 'Проклятье Бурмалдиньо',
		description: `В следующие (S 20) (M 40) (L 60) минут ты должен бросать кубик перед каждым шагом в любом направлении. Ты можешь сделать столько шагов, сколько выпало, прежде чем бросить снова.`,
		bylaws: `Для этого проклятья нужно использовать d6. Если искателей несколько, они могут бросать кубики независимо или использовать один кубик для всех — любой вариант допустим. Если искатели случайно сделали лишние шаги, они должны остановиться и бросить кубик задним числом, чтобы компенсировать все неучтённые шаги. Делать неучтённые шаги намеренно нельзя, кроме случаев, когда это небезопасно (например, переход оживлённой дороги).`,
		file: 'curse_gamblers_feet',
	},
	curse_hidden_hangman: {
		type: 'curse',
		title: 'Проклятье Скрытого Висельника',
		description: `Прежде чем задать новый вопрос или сесть в транспорт, ты должен обыграть меня в виселицу. Я выберу слово из 5 букв, игра заканчивается после угадывания слова или 7 неверных букв. Я буду отвечать на все запросы в течение 30 секунд. Если ты проиграешь, повторно бросить вызов сможешь только через 10 минут. После (S 1) (M 2) (L 3) проигрышей нужно ждать ещё 10 минут, после чего проклятье снимается.`,
		bylaws: `Выбранное слово из пяти букв должно быть настоящим, найденным в словаре на языке игры. Например, нельзя использовать французское слово, если все игроки говорят только по-английски. Если спрятавшийся не отвечает на запрос в течение 30 секунд, проклятье мгновенно снимается.`,
		file: 'curse_hidden_hangman',
	},
	curse_impressionable_consumer: {
		type: 'curse',
		title: 'Проклятье Легковерного Покупателя',
		description: `Тебе нужно зайти и получить доступ в место или купить продукт, который ты увидел в рекламе, прежде чем задать новый вопрос. Реклама должна быть найдена в реальном мире, не на твоём устройстве, и находиться минимум в 30 метрах от продукта или места.`,
		bylaws: `Любой объект или дисплей, чья основная цель — привлечь внимание к продукту, услуге или бизнесу, считается рекламой. Если реклама касается конкретной услуги, например массажа, искатели должны оплатить и получить эту услугу. Если реклама о месте, но не об услуге, например парке развлечений, нужно просто зайти туда. Места, которые не являются частным бизнесом, например общественный парк, не считаются. Если ты не хочешь тратить деньги для выполнения этого проклятья, его нужно убрать из колоды.`,
		file: 'curse_impressionable_consumer',
	},
	curse_jammed_door: {
		type: 'curse',
		title: 'Проклятье Заклинившей Двери',
		description: `В следующие (S 0.5) (M 1) (L 3) часа, когда ты хочешь пройти через дверь в здание, бизнес, поезд или другое транспортное средство, сначала нужно бросить 2 кубика. Если не выпало 7 или больше, ты не можешь войти (включая через другие двери). Попытку можно повторить через (S 5) (M 10) (L 15) минут.`,
		bylaws: `Искатели должны бросать два d6. Кубики можно бросать только когда дверь видна искателям. Например, если ты пытаешься войти в поезд, кубики нельзя бросать до его прибытия; нужно сначала увидеть дверь поезда. Двери внутри здания, ведущие в другие его части, например магазин на вокзале, не требуют проверки кубиков. Если есть спор о том, считается ли что-то отдельным зданием, лучше провести проверку кубиков. Если проклятье истекает, пока дверь на перезарядке, перезарядка тоже сразу заканчивается.`,
		file: 'curse_jammed_door',
	},
	curse_labyrinth: {
		type: 'curse',
		title: 'Проклятье Лабиринта',
		description: `Я только что нарисовал лабиринт. Тебе нужно его решить, прежде чем задать новый вопрос.`,
		bylaws: `"Решение" в данном контексте означает стандартное прохождение лабиринта — ты должен провести непрерывную линию от начала до конца. Таймер начинается с момента, когда ты начнёшь рисовать первую линию; время на сбор материалов не считается. Ты можешь выбросить лабиринт и начать новый в любой момент, но таймер не сбрасывается. Использовать интернет или другие материалы нельзя; лабиринт должен быть нарисован только из твоей головы.`,
		file: 'curse_labyrinth',
	},
	curse_lemon_phylactery: {
		type: 'curse',
		title: 'Проклятье Лимонного Филактерия',
		description: `Тебе нужно найти лимон и прикрепить его к самому внешнему слою одежды или кожи. Если в какой-то момент лимон перестанет касаться тебя, я получаю бонус: (S 30) (M 45) (L 60) минут.`,
		bylaws: `Лимон должен быть настоящим. Его можно прикрепить любым способом, но он должен постоянно касаться кожи или одежды искателя. Как только лимон упадёт, спрятавшемуся нужно сразу сообщить о бонусе.`,
		file: 'curse_lemon_phylactery',
	},
	curse_luxury_car: {
		type: 'curse',
		title: 'Проклятье Карспоттера',
		description: `Я только что сфотографировал машину. Тебе нужно сфотографировать машину дороже, прежде чем задать новый вопрос.`,
		bylaws: `Ты должен идентифицировать машину, отправив фото, и искатели должны согласиться, что это именно та машина, что ты указал. Используй начальную розничную цену (MSRP) машины, учитывая год выпуска, без учёта допов или модификаций (например, улучшения интерьера, специальные шины, цвета и т.д.). Фото, отправленное искателям, должно показывать достаточно машины для её распознавания. Эти правила применяются и к машине, найденной искателями. Если нельзя подтвердить точный год или модель, обе стороны должны договориться о модели и годе для определения цены.`,
		file: 'curse_luxury_car',
	},
	curse_mediocre_travel_agent: {
		type: 'curse',
		title: 'Проклятье Посредственного Турагента',
		description: `Я выбрал общедоступное место в радиусе (S 0.4) (M 0.4) (L 0.8) километра от твоего текущего местоположения. Тебе нужно туда сходить и провести там не менее (S 5) (M 5) (L 10) минут, прежде чем задать новый вопрос. Отправь мне минимум три фото, где ты наслаждаешься отпуском, и захвати сувенир, чтобы принести мне. Если сувенир потеряется до того, как ты сможешь мне его дать, я получаю бонус: (S 30) (M 45) (L 60) минут.`,
		bylaws: `"Общедоступное" в данном контексте следует тем же правилам, что и "общедоступное" для укрытий. Место не обязательно точка; это может быть небольшая общая зона, как парк или магазин. Сувенир может быть любым физическим объектом. Он не должен быть с искателями всё время, но должен быть с ними, когда спрятавшийся будет пойман.`,
		file: 'curse_mediocre_travel_agent',
	},
	curse_ransom_note: {
		type: 'curse',
		title: 'Проклятье Выкупного Письма',
		description: `Твой следующий вопрос должен быть составлен из слов и букв, вырезанных из любого печатного материала. Вопрос должен быть понятным и содержать минимум 5 слов.`,
		bylaws: `Ты не можешь начать выполнять стоимость применения этого проклятья, если иначе не можешь сыграть проклятье; как только стоимость выполнена, проклятье должно быть применено немедленно. Печатный материал не должен быть напечатан искателями; буквы нужно собрать из журналов, газет или других материалов, найденных в реальном мире. "Понятность" в данном контексте не обязательно означает полные предложения, но спрятавшийся должен понять смысл вопроса без дополнительных разъяснений. Можно использовать понятные сокращения (например, "2" вместо "to"). Если вопрос требует контекста вне базового предложения, этот контекст НЕ нужно предоставлять в виде выкупного письма. Например, для термометра можно спросить что-то вроде: "Пошёл 5 миль. Жарче/холоднее?" Дополнительная информация о начале и конце термометра может быть предоставлена как обычно, в виде метки местоположения или текста.`,
		file: 'curse_ransom_note',
	},
	curse_right_turn: {
		type: 'curse',
		title: 'Проклятье Правого Поворота',
		description: `В следующие (S 20) (M 40) (L 60) минут ты можешь поворачивать только направо на любом перекрёстке. Если ты попадёшь в тупик, где не можешь идти вперёд или поворачивать направо ещё 300 метров, можешь сделать полный разворот на 180°. Правый поворот — это дорога под любым углом, уходящая вправо от тебя.`,
		bylaws: `Это проклятье применяется только к уличным перекрёсткам, то есть пересечениям двух дорог, предназначенных для машин (или пешеходных тротуаров вдоль этих дорог). Проклятье не действует indoors или в зонах без улиц.`,
		file: 'curse_right_turn',
	},
	curse_spotty_memory: {
		type: 'curse',
		title: 'Проклятье Пятнистой Памяти',
		description: `На всё моё время игры одна случайная категория вопросов будет отключена постоянно. Тебе нужно бросить кубик, чтобы определить категорию вопросов, которую отключат. Эта категория остаётся отключённой до следующего вопроса, после чего кубик снова бросается для выбора новой категории. Одна и та же категория может отключаться несколько раз подряд.`,
		bylaws: `Искатели должны назначить номера кубика каждой категории перед первым броском. Для маленьких игр, где всего пять категорий вопросов, выпавший 6 требует переброса.`,
		file: 'curse_spotty_memory',
	},
	curse_the_bird_guide: {
		type: 'curse',
		title: 'Проклятье Птичьего Гида',
		description: `Я снял видео с птицей на ___ минут подряд. Тебе нужно снять видео с птицей на такое же время или дольше, прежде чем задать новый вопрос.`,
		bylaws: `Птица должна быть в кадре с момента начала видео. Она считается "в кадре", если хоть какая-то узнаваемая часть птицы видна на камере. У искателей неограниченное количество попыток.`,
		file: 'curse_the_bird_guide',
	},
	curse_the_unguided_tourist: {
		type: 'curse',
		title: 'Проклятье Непутёвого Туриста',
		description: `Я нашёл изображение на Google Street View в 150 метрах от твоего текущего местоположения. Без использования интернета для исследований ты должен найти это в реальной жизни, прежде чем использовать транспорт или задать новый вопрос. Отправь мне фото для подтверждения.`,
		bylaws: `Строение, созданное человеком, не может быть частью дороги, включая бордюры или тротуары. Если игра ведётся в стране или зоне с ограниченным покрытием Google Street View (например, Германия), это проклятье нужно убрать из колоды.`,
		file: 'curse_the_unguided_tourist',
	},
	curse_the_uturn: {
		type: 'curse',
		title: 'Проклятье Разворота',
		description: `Ты должен сойти с текущего вида транспорта на следующей станции (при условии, что другая форма транспорта будет доступна в следующие (S 0.5) (M 0.5) (L 1) часов).`,
		bylaws: `"Следующая станция" в данном контексте — это следующая станция, на которой остановится текущий транспорт искателей; если маршрут пропускает какие-то остановки, их игнорируют. Если ты не уверен, на транспорте ли искатели или остановится ли их маршрут на конкретной станции, можешь спросить у них. Если есть неясность, при применении проклятья укажи, какую станцию считаешь следующей, чтобы подтвердить, что ты не ошибся с их трекером. Даже если текущий транспорт со временем приблизит их к тебе, проклятье можно сыграть, если следующая станция дальше; линия, которая временно уходит в сторону, особенно выгодна для этого проклятья.`,
		file: 'curse_the_uturn',
	},
	curse_urban_explorer: {
		type: 'curse',
		title: 'Проклятье Городского Исследователя',
		description: `На всё моё время игры ты не можешь задавать вопросы, находясь в транспорте или на станции транспорта.`,
		bylaws: `Любые ожидающие вопросы, заданные в транспорте до применения этого проклятья, всё равно должны быть отвечены. Вопросы можно задавать вне станций транспорта, но искатели не должны быть на платформе или в любом здании, связанном со станцией, когда задают вопросы.`,
		file: 'curse_urban_explorer',
	},
	curse_water_weight: {
		type: 'curse',
		title: 'Проклятье Водоноса',
		description: `Ты должен достать и носить не менее 2 литров жидкости на каждого искателя на всё моё время игры. Ты не можешь задать новый вопрос, пока не достанешь жидкость. Жидкость можно распределить между искателями по твоему усмотрению. Если жидкость потеряется или будет оставлена после получения, я получаю бонус: (S 30) (M 30) (L 60) минут.`,
		bylaws: `Любая жидкость, которая уже была с искателями на момент применения карты (например, бутылки с водой), не считается. Жидкость может быть в любом количестве контейнеров и передаваться между искателями в любое время. Её можно поставить, когда искатели стоят на месте или в транспорте, но она считается "оставленной", если находится дальше 3 метров от любого искателя. Спрятавшемуся нужно сразу сообщить о бонусе. "Водоём" в данном контексте не обязательно природный, но не может быть бассейном и должен быть достаточно большим, чтобы быть обозначенным на карте.`,
		file: 'curse_water_weight',
	},
	curse_zoologist: {
		type: 'curse',
		title: 'Проклятье Зоолога',
		description: `Я сфотографировал дикую рыбу, птицу, млекопитающее, рептилию, амфибию или насекомое. Тебе нужно сфотографировать дикое животное из той же категории, прежде чем задать новый вопрос.`,
		bylaws: `"Насекомое" в данном контексте включает любых насекомых, пауков, двупарных или членистоногих, или всё, что обычно называют "насекомым". "Дикое" означает не прирученное и не содержащееся в человеческом плену, включая крупные открытые формы плена, такие как фермы или заповедники. Фото должно показывать достаточно животного, чтобы его можно было распознать в категории. Если есть спор о классификации животного, ориентируйся на Википедию. Животные вне этих категорий (например, ракообразные) для этого проклятья не подходят.`,
		file: 'curse_zoologist',
	},
	powerup_move: {
		type: 'powerup',
		title: 'Перемещение',
		description: `Я отправил тебе местоположение моей текущей станции транспорта. У меня есть (S 10) (M 20) (L 60) минут, чтобы установить новую зону укрытия где-то ещё на карте игры. Мой таймер укрытия приостановлен, и ты должен заморозиться, пока мой новый период укрытия не завершится.`,
		bylaws: `Карта перемещения, если использовать её в нужный момент, может быть одной из самых мощных в игре. При использовании тебе даётся определённое время, в зависимости от размера игры, чтобы установить новую зону укрытия. Правила поиска новой зоны укрытия применяются как обычно; ты должен центрироваться на новой станции транспорта и использовать только допустимый транспорт для достижения нового места. Пока ты двигаешься, твой таймер укрытия приостановлен, а искатели должны остаться на месте и не задавать вопросы, пока таймер перемещения не истечёт. После этого игра возобновляется, и твой таймер укрытия продолжает идти с того момента, где он остановился при использовании карты перемещения. Важно сделать это в идеальный момент, так как использование перемещения связано с серьёзной стоимостью — ты должен сразу сбросить всю руку и сообщить искателям о своей исходной станции транспорта после её применения. Поскольку перемещение нельзя использовать в конце игры, ты должен быть уверен, что искатели близко к тебе, и что лучше начать с нуля, чем использовать накопленные карты. Используй мудро!`,
		file: 'powerup_move',
	},
	powerup_randomize_question: {
		type: 'powerup',
		title: 'Случайный Вопрос',
		description: `Вместо ответа на твой вопрос ты должен выбрать новый вопрос из той же категории случайно, на который я отвечу вместо этого.`,
		bylaws: `Карта случайного вопроса может быть сыграна в ответ на любой вопрос вместо ответа. После того как искатели узнают, что ты использовал карту случайного вопроса, они должны выбрать — случайно, с помощью генератора случайных чисел или кубика — другой не заданный вопрос из той же категории (например, радар на 10 километров может стать радаром на 50 километров). Этот вопрос автоматически задаётся вместо, и я даю ответ как обычно. Оригинальный вопрос не считается заданным и может быть задан снова за его исходную стоимость. Если случайный вопрос даёт пустой ответ, это допустимо (жаль, конечно). Ты можешь сыграть случайный вопрос в любое время в окне ответа после того, как вопрос был задан.`,
		file: 'powerup_randomize_question',
	},
	powerup_veto_question: {
		type: 'powerup',
		title: 'Вето на Вопрос',
		description: `Я наложил вето на твой вопрос.`,
		bylaws: `Карта вето может быть сыграна в ответ на любой вопрос вместо ответа. Искатели не получают ответа на свой вопрос и узнают, что ты использовал вето. Вопрос всё равно считается заданным и может быть задан снова только за дополнительную стоимость. Поскольку ты не ответил на вопрос, ты не получаешь награду и не тянешь карты из колоды спрятавшегося. Ты можешь сыграть вето в любое время в окне ответа после того, как вопрос был задан.`,
		file: 'powerup_veto_question',
	},
};

export async function shareCardImage(cardFile: string) {
	const imageUrl = `${window.location.origin}/img/cards/${cardFile}.png`;

	try {
		const response = await fetch(imageUrl);
		const blob = await response.blob();
		const file = new File([blob], `${cardFile}.png`, { type: blob.type });

		if (navigator.canShare && navigator.canShare({ files: [file] })) {
			await navigator.share({
				files: [file],
				title: cardData[cardFile].title,
				text: getText(cardFile),
			});
		} else {
			alert('Your device does not support sharing files.');
		}
	} catch (error) {
		console.error('Error sharing card image:', error);
		alert('There was a problem sharing the card.');
	}
}

function getText(cardFile: string): string {
	const card = cardData[cardFile];
	let text = '';
	if (card.type === 'curse') {
		text += "You've been cursed!\n\n";
		text += `${card.title}\n\n`;
	} else {
		text += `I've played a ${card.title} card!\n\n`;
	}

	text += card.description;
	// text += 'Information about this card:\n\n';
	// text += card.bylaws;

	return text;
}

export function canBeShared(cardFile: string): boolean {
	return !!cardData[cardFile];
}
